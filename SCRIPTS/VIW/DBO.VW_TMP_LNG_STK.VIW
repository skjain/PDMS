CREATE VIEW VW_TMP_LNG_STK AS 
SELECT DISTINCT COMP,UNIT,CHLN,PCOD,ICOD,SUM(QNTY) AS QNTY FROM STORETRAN 
WHERE VTYP='IVR' AND DBCD='000006' AND OPER ='+' AND RECSTAT<>'D' AND CHLN IS NOT NULL AND LTRIM(RTRIM(CHLN))<>'' 
GROUP BY COMP,UNIT,CHLN,PCOD,ICOD
UNION
SELECT DISTINCT COMP,UNIT,CHLN,PCOD,ICOD,-SUM(QNTY) AS QNTY FROM STORETRAN 
WHERE VTYP='LNG' AND OPER ='-' AND RECSTAT<>'D' AND CHLN IS NOT NULL AND LTRIM(RTRIM(CHLN))<>'' 
GROUP BY COMP,UNIT,CHLN,PCOD,ICOD
